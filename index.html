<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Portfolio Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: white;
            font-size: 2.5em;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }

        .header p {
            color: rgba(255,255,255,0.9);
            font-size: 1.1em;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
        }

        .stat-card h3 {
            font-size: 0.9em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .stat-card .value {
            font-size: 2em;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .positive { color: #10b981; }
        .negative { color: #ef4444; }
        .neutral { color: #3b82f6; }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            align-items: start;
        }

        .add-stock-form {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .add-stock-form h2 {
            margin-bottom: 25px;
            color: #333;
            font-size: 1.5em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            padding: 8px 16px;
            font-size: 14px;
            width: auto;
        }

        .btn-export {
            background: linear-gradient(135deg, #10b981, #059669);
            margin-bottom: 10px;
        }

        .stocks-list {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .stocks-list h2 {
            margin-bottom: 25px;
            color: #333;
            font-size: 1.5em;
        }

        .stock-item {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #3b82f6;
            transition: all 0.3s ease;
        }

        .stock-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .stock-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .stock-symbol {
            font-size: 1.3em;
            font-weight: 700;
            color: #1f2937;
        }

        .stock-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            font-size: 0.9em;
        }

        .detail-item {
            text-align: center;
        }

        .detail-label {
            color: #6b7280;
            font-size: 0.8em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .detail-value {
            font-weight: 600;
            font-size: 1.1em;
        }

        .no-stocks {
            text-align: center;
            color: #6b7280;
            font-size: 1.1em;
            padding: 40px;
        }

        .file-input {
            margin-bottom: 10px;
        }

        .file-input input[type="file"] {
            display: none;
        }

        .file-input label {
            display: inline-block;
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .file-input label:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .dashboard {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stock-details {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìà Stock Portfolio Tracker</h1>
            <p>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡πà‡∏≤‡∏¢‡∏î‡∏≤‡∏¢</p>
        </div>

        <div class="dashboard">
            <div class="stat-card">
                <h3>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏∏‡πâ‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                <div class="value neutral" id="totalStocks">0</div>
            </div>
            <div class="stat-card">
                <h3>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏£‡∏ß‡∏°</h3>
                <div class="value neutral" id="totalInvestment">‡∏ø0</div>
            </div>
            <div class="stat-card">
                <h3>‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</h3>
                <div class="value neutral" id="currentValue">‡∏ø0</div>
            </div>
            <div class="stat-card">
                <h3>‡∏Å‡∏≥‡πÑ‡∏£/‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô</h3>
                <div class="value neutral" id="totalPnL">‡∏ø0</div>
            </div>
        </div>

        <div class="main-content">
            <div class="add-stock-form">
                <h2>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏∏‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà</h2>
                <form id="stockForm">
                    <div class="form-group">
                        <label for="symbol">‡∏£‡∏´‡∏±‡∏™‡∏´‡∏∏‡πâ‡∏ô</label>
                        <input type="text" id="symbol" placeholder="‡πÄ‡∏ä‡πà‡∏ô AAPL, KBANK" required>
                    </div>
                    <div class="form-group">
                        <label for="quantity">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏∏‡πâ‡∏ô</label>
                        <input type="number" id="quantity" placeholder="100" required>
                    </div>
                    <div class="form-group">
                        <label for="costPrice">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô (‡∏ø)</label>
                        <input type="number" step="0.01" id="costPrice" placeholder="50.00" required>
                    </div>
                    <div class="form-group">
                        <label for="currentPrice">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡∏ø)</label>
                        <input type="number" step="0.01" id="currentPrice" placeholder="55.00" required>
                    </div>
                    <button type="submit" class="btn">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏∏‡πâ‡∏ô</button>
                </form>

                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e5e7eb;">
                    <button onclick="exportData()" class="btn btn-export">üì§ Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
                    <div class="file-input">
                        <label for="importFile">üì• Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</label>
                        <input type="file" id="importFile" accept=".json" onchange="importData(event)">
                    </div>
                </div>
            </div>

            <div class="stocks-list">
                <h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏∏‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
                <div id="stocksList"></div>
            </div>
        </div>
    </div>

    <script>
        let stocks = [];

        // Load data from localStorage on page load
        function initializeApp() {
            loadData();
            updateDashboard();
            displayStocks();
            console.log('App initialized successfully');
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }

        // Add stock form handler
        function addStock() {
            const symbol = document.getElementById('symbol').value.toUpperCase().trim();
            const quantity = parseInt(document.getElementById('quantity').value);
            const costPrice = parseFloat(document.getElementById('costPrice').value);
            const currentPrice = parseFloat(document.getElementById('currentPrice').value);
            
            // Validation
            if (!symbol || isNaN(quantity) || isNaN(costPrice) || isNaN(currentPrice)) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                return false;
            }
            
            if (quantity <= 0 || costPrice <= 0 || currentPrice <= 0) {
                alert('‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0');
                return false;
            }
            
            const stock = {
                id: Date.now(),
                symbol,
                quantity,
                costPrice,
                currentPrice,
                totalCost: quantity * costPrice,
                currentValue: quantity * currentPrice,
                pnl: (currentPrice - costPrice) * quantity,
                pnlPercent: ((currentPrice - costPrice) / costPrice) * 100
            };
            
            stocks.push(stock);
            saveData();
            updateDashboard();
            displayStocks();
            
            // Reset form
            document.getElementById('stockForm').reset();
            
            // Show success message
            alert(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏∏‡πâ‡∏ô ${symbol} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`);
            return false;
        }

        // Add event listener after DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('stockForm');
            if (form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    addStock();
                });
            }
        });

        function updateDashboard() {
            const totalStocks = stocks.length;
            const totalInvestment = stocks.reduce((sum, stock) => sum + stock.totalCost, 0);
            const currentValue = stocks.reduce((sum, stock) => sum + stock.currentValue, 0);
            const totalPnL = currentValue - totalInvestment;
            
            document.getElementById('totalStocks').textContent = totalStocks;
            document.getElementById('totalInvestment').textContent = formatCurrency(totalInvestment);
            document.getElementById('currentValue').textContent = formatCurrency(currentValue);
            
            const pnlElement = document.getElementById('totalPnL');
            pnlElement.textContent = formatCurrency(totalPnL);
            pnlElement.className = `value ${totalPnL > 0 ? 'positive' : totalPnL < 0 ? 'negative' : 'neutral'}`;
        }

        function displayStocks() {
            const container = document.getElementById('stocksList');
            
            if (stocks.length === 0) {
                container.innerHTML = '<div class="no-stocks">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏∏‡πâ‡∏ô‡πÉ‡∏ô‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>';
                return;
            }
            
            container.innerHTML = stocks.map(stock => `
                <div class="stock-item">
                    <div class="stock-header">
                        <div class="stock-symbol">${stock.symbol}</div>
                        <button class="btn btn-danger" onclick="deleteStock(${stock.id})">‡∏•‡∏ö</button>
                    </div>
                    <div class="stock-details">
                        <div class="detail-item">
                            <div class="detail-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</div>
                            <div class="detail-value">${stock.quantity.toLocaleString()}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô</div>
                            <div class="detail-value">‡∏ø${stock.costPrice.toFixed(2)}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
                            <div class="detail-value">‡∏ø${stock.currentPrice.toFixed(2)}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∏‡∏ô</div>
                            <div class="detail-value">${formatCurrency(stock.totalCost)}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
                            <div class="detail-value">${formatCurrency(stock.currentValue)}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">‡∏Å‡∏≥‡πÑ‡∏£/‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô</div>
                            <div class="detail-value ${stock.pnl > 0 ? 'positive' : stock.pnl < 0 ? 'negative' : 'neutral'}">
                                ${formatCurrency(stock.pnl)} (${stock.pnlPercent.toFixed(2)}%)
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function deleteStock(id) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏´‡∏∏‡πâ‡∏ô‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ?')) {
                stocks = stocks.filter(stock => stock.id !== id);
                saveData();
                updateDashboard();
                displayStocks();
            }
        }

        function formatCurrency(amount) {
            return `‡∏ø${Math.abs(amount).toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
        }

        function saveData() {
            localStorage.setItem('stockPortfolio', JSON.stringify(stocks));
        }

        function loadData() {
            const data = localStorage.getItem('stockPortfolio');
            if (data) {
                stocks = JSON.parse(data);
            }
        }

        function exportData() {
            const dataStr = JSON.stringify(stocks, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `stock-portfolio-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            URL.revokeObjectURL(url);
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedStocks = JSON.parse(e.target.result);
                    if (confirm('‡∏Å‡∏≤‡∏£ Import ‡∏à‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏° ‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                        stocks = importedStocks;
                        saveData();
                        updateDashboard();
                        displayStocks();
                        alert('Import ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    }
                } catch (error) {
                    alert('‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå JSON ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                }
                
                // Reset file input
                event.target.value = '';
            };
            reader.readAsText(file);
        }
    </script>
</body>
</html>